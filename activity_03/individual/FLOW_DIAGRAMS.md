# ğŸ”„ LOGIN & REGISTRATION FLOW DIAGRAM

## ğŸ“Š Complete System Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER VISITS WEBSITE                         â”‚
â”‚                  (Opens browser, types URL)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   index.php     â”‚ â—„â”€â”€ Main Login Page
                   â”‚  (Login Page)   â”‚     (Entry Point)
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                           â”‚
              â–¼                           â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ Has Account?  â”‚          â”‚ New User?    â”‚
      â”‚   YES         â”‚          â”‚   NO         â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                         â”‚
              â”‚                         â”‚ Clicks "Register here"
              â”‚                         â”‚
              â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ENTERS CREDENTIALS      â”‚  â”‚   register.php           â”‚
â”‚  â€¢ Email                 â”‚  â”‚   (Registration Form)    â”‚
â”‚  â€¢ Password              â”‚  â”‚                          â”‚
â”‚  â€¢ Clicks "Sign In"      â”‚  â”‚  User fills:             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â€¢ Name                  â”‚
           â”‚                  â”‚  â€¢ Email                 â”‚
           â”‚                  â”‚  â€¢ Password              â”‚
           â”‚                  â”‚  â€¢ Confirm Password      â”‚
           â”‚                  â”‚  â€¢ Role (Student/Faculty)â”‚
           â”‚                  â”‚  â€¢ Ashesi ID             â”‚
           â”‚                  â”‚  â€¢ Clicks "Create        â”‚
           â”‚                  â”‚    Account"              â”‚
           â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â”‚                           â”‚ SUBMIT
           â”‚                           â–¼
           â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                  â”‚ register_handler.php    â”‚
           â”‚                  â”‚ (Process Registration)  â”‚
           â”‚                  â”‚                         â”‚
           â”‚                  â”‚ 1. Validate CSRF token  â”‚
           â”‚                  â”‚ 2. Check all fields     â”‚
           â”‚                  â”‚ 3. Validate email formatâ”‚
           â”‚                  â”‚ 4. Check passwords matchâ”‚
           â”‚                  â”‚ 5. Check password strongâ”‚
           â”‚                  â”‚ 6. Check email unique   â”‚
           â”‚                  â”‚ 7. Check ID unique      â”‚
           â”‚                  â”‚ 8. Hash password        â”‚
           â”‚                  â”‚ 9. Insert to database   â”‚
           â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â”‚                           â”‚ SUCCESS
           â”‚                           â–¼
           â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                  â”‚ Redirect to index.php   â”‚
           â”‚                  â”‚ + Success Message       â”‚
           â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                           â”‚
           â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ SUBMIT FORM
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  login_handler.php        â”‚
â”‚  (Process Login)          â”‚
â”‚                           â”‚
â”‚  1. Get email & password  â”‚
â”‚  2. Validate not empty    â”‚
â”‚  3. Verify CSRF token     â”‚
â”‚  4. Validate email format â”‚
â”‚  5. Query database        â”‚
â”‚  6. Check user exists     â”‚
â”‚  7. Verify password hash  â”‚
â”‚  8. Create session vars:  â”‚
â”‚     $_SESSION['user_id']  â”‚
â”‚     $_SESSION['name']     â”‚
â”‚     $_SESSION['email']    â”‚
â”‚     $_SESSION['role']     â”‚
â”‚  9. Update last_login     â”‚
â”‚  10. Regenerate session   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ AUTHENTICATION SUCCESS
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Redirect to               â”‚
â”‚   dashboard.php             â”‚
â”‚   + Welcome Message         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              dashboard.php                       â”‚
â”‚           (Protected Page)                       â”‚
â”‚                                                  â”‚
â”‚  1. Check isLoggedIn() â”€â”€â”€â”€â”€â”€â”€â–º NO â”€â”€â”€â”€â”€â”       â”‚
â”‚  2. If not logged in                    â”‚       â”‚
â”‚     â†’ Redirect to index.php             â”‚       â”‚
â”‚                                         â”‚       â”‚
â”‚  3. If logged in:                       â”‚       â”‚
â”‚     â€¢ Get user info from session        â”‚       â”‚
â”‚     â€¢ Query database for courses        â”‚       â”‚
â”‚     â€¢ Query attendance stats            â”‚       â”‚
â”‚     â€¢ Display role-based content:       â”‚       â”‚
â”‚                                         â”‚       â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚       â”‚
â”‚       â”‚            â”‚            â”‚       â”‚       â”‚
â”‚       â–¼            â–¼            â–¼       â”‚       â”‚
â”‚   STUDENT      FACULTY      ADMIN       â”‚       â”‚
â”‚   â€¢ Courses    â€¢ My Courses â€¢ Overview â”‚       â”‚
â”‚   â€¢ Stats      â€¢ Sessions   â€¢ Users    â”‚       â”‚
â”‚   â€¢ History    â€¢ Mark Attn  â€¢ Reports  â”‚       â”‚
â”‚   â€¢ Issues     â€¢ Reports               â”‚       â”‚
â”‚                                         â”‚       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚  index.php   â”‚
                                   â”‚  (Redirect)  â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Session Flow (Behind the Scenes)

```
SESSION LIFECYCLE:

1. VISIT SITE
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  config.php    â”‚
   â”‚  loads         â”‚
   â”‚  session_start()â”‚ â—„â”€â”€ Creates/resumes session
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. LOGIN SUCCESS
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  login_handler.php         â”‚
   â”‚                            â”‚
   â”‚  $_SESSION['user_id'] = 5  â”‚
   â”‚  $_SESSION['name'] = "John"â”‚
   â”‚  $_SESSION['role'] = "std" â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ Session stored on server
           â”‚ Cookie sent to browser
           â”‚
           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Browser gets cookie       â”‚
   â”‚  PHPSESSID=abc123xyz...    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. VISIT PROTECTED PAGE
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Browser sends cookie      â”‚
   â”‚  PHPSESSID=abc123xyz...    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  config.php                â”‚
   â”‚  session_start()           â”‚
   â”‚  â†’ Reads session data      â”‚
   â”‚  â†’ Finds user_id = 5       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  helpers.php               â”‚
   â”‚  isLoggedIn()              â”‚
   â”‚  â†’ Check isset user_id     â”‚
   â”‚  â†’ Returns TRUE âœ…         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  dashboard.php             â”‚
   â”‚  â†’ Access GRANTED          â”‚
   â”‚  â†’ Show user dashboard     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. LOGOUT
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  logout.php                â”‚
   â”‚  session_destroy()         â”‚
   â”‚  â†’ Clear all session data  â”‚
   â”‚  â†’ Delete cookie           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Redirect to index.php     â”‚
   â”‚  â†’ Back to login page      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ Password Security Flow

```
REGISTRATION (Creating Account):

User enters: "MyPass123!"
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ register_handler.php    â”‚
â”‚                         â”‚
â”‚ $hash = password_hash(  â”‚
â”‚   "MyPass123!",         â”‚
â”‚   PASSWORD_DEFAULT      â”‚
â”‚ )                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼ 
Stored in database:
"$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2..."
(Encrypted, cannot be reversed)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

LOGIN (Verifying Account):

User enters: "MyPass123!"
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ login_handler.php                   â”‚
â”‚                                     â”‚
â”‚ 1. Get hash from database:          â”‚
â”‚    "$2y$10$92IXUNp..."              â”‚
â”‚                                     â”‚
â”‚ 2. Verify:                          â”‚
â”‚    password_verify(                 â”‚
â”‚      "MyPass123!",      â—„â”€â”€ User input
â”‚      "$2y$10$92IXUNp..." â—„â”€â”€ From DB
â”‚    )                                â”‚
â”‚                                     â”‚
â”‚ 3. Returns TRUE if match âœ…         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›¡ï¸ CSRF Protection Flow

```
FORM DISPLAY:

1. User visits register.php or index.php
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  helpers.php               â”‚
   â”‚  generateCSRFToken()       â”‚
   â”‚  â†’ Create random token     â”‚
   â”‚  â†’ Store in session        â”‚
   â”‚  â†’ Return token            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  HTML Form                 â”‚
   â”‚  <input type="hidden"      â”‚
   â”‚   name="csrf_token"        â”‚
   â”‚   value="abc123xyz..."     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

FORM SUBMISSION:

2. User clicks submit
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Browser sends:            â”‚
   â”‚  â€¢ Form data               â”‚
   â”‚  â€¢ csrf_token=abc123xyz... â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
3. Handler verifies token
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  login_handler.php         â”‚
   â”‚  verifyCSRFToken()         â”‚
   â”‚                            â”‚
   â”‚  Compare:                  â”‚
   â”‚  $_POST['csrf_token']      â”‚
   â”‚  vs                        â”‚
   â”‚  $_SESSION['csrf_token']   â”‚
   â”‚                            â”‚
   â”‚  Must match! âœ…            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WHY?
Prevents hackers from submitting forms
from other websites pretending to be you!
```

---

## ğŸ“Š Database Query Flow

```
EXAMPLE: Login Process

1. User submits: john.doe@ashesi.edu.gh
                 Password123!

2. login_handler.php processes:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  $stmt = $pdo->prepare(             â”‚
   â”‚    "SELECT * FROM users             â”‚
   â”‚     WHERE email = :email"           â”‚
   â”‚  );                                 â”‚
   â”‚                                     â”‚
   â”‚  $stmt->execute([                   â”‚
   â”‚    'email' => 'john.doe@...'        â”‚
   â”‚  ]);                                â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  MySQL Database                     â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   â”‚  â”‚ users table                  â”‚   â”‚
   â”‚  â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
   â”‚  â”‚ ID â”‚ Name â”‚ Email  â”‚ Pass   â”‚   â”‚
   â”‚  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
   â”‚  â”‚ 1  â”‚ John â”‚ john.. â”‚ $2y$.. â”‚â—„â”€â”€â”¤ FOUND!
   â”‚  â”‚ 2  â”‚ Mary â”‚ mary.. â”‚ $2y$.. â”‚   â”‚
   â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Result returned to PHP:            â”‚
   â”‚  [                                  â”‚
   â”‚    'user_id' => 1,                  â”‚
   â”‚    'name' => 'John Doe',            â”‚
   â”‚    'email' => 'john.doe@...',       â”‚
   â”‚    'password' => '$2y$10$...',      â”‚
   â”‚    'role' => 'student'              â”‚
   â”‚  ]                                  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Verify password                    â”‚
   â”‚  password_verify()                  â”‚
   â”‚  âœ… MATCH â†’ Login successful        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Complete File Interaction Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  index.php   â”‚ Login page
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ requires
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º config.php (DB + session)
       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º helpers.php (functions)
                      â”‚
                      â”œâ”€ isLoggedIn()
                      â”œâ”€ generateCSRFToken()
                      â”œâ”€ getFlashMessage()
                      â””â”€ redirectToDashboard()

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ register.php     â”‚ Registration page
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ requires (same as above)
       â”‚
       â”‚ submits to
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ register_handler.php   â”‚ Process registration
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ requires
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º config.php
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º helpers.php
       â”‚
       â”‚ uses functions:
       â”œâ”€ sanitizeInput()
       â”œâ”€ verifyCSRFToken()
       â”œâ”€ setFlashMessage()
       â”‚
       â”‚ inserts to
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º DATABASE (users table)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ login_handler.phpâ”‚ Process login
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ requires
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º config.php
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º helpers.php
       â”‚
       â”‚ uses functions:
       â”œâ”€ verifyCSRFToken()
       â”œâ”€ isValidEmail()
       â”œâ”€ verifyPassword()
       â”œâ”€ redirect()
       â”‚
       â”‚ queries
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º DATABASE (users table)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ dashboard.php    â”‚ Main dashboard
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ requires
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º config.php
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º helpers.php
       â”‚
       â”‚ uses functions:
       â”œâ”€ isLoggedIn()
       â”œâ”€ getFlashMessage()
       â”‚
       â”‚ queries
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º DATABASE (multiple tables)
                      â”œâ”€ courses
                      â”œâ”€ enrollments
                      â”œâ”€ sessions
                      â””â”€ attendance

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ logout.php       â”‚ End session
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ requires
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º config.php
       â”‚
       â”‚ actions:
       â”œâ”€ session_destroy()
       â””â”€ redirect to index.php
```

---

## ğŸ”„ Error Handling Flow

```
Any point in the flow can generate errors:

ERROR OCCURS
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Handler detects problem â”‚
â”‚ (login_handler.php)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ setFlashMessage(        â”‚
â”‚   'error',              â”‚
â”‚   'Invalid password'    â”‚
â”‚ )                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redirect back to form   â”‚
â”‚ header('Location: ...')  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Form page loads         â”‚
â”‚ getFlashMessage()       â”‚
â”‚ â†’ Display error to user â”‚
â”‚ â†’ Clear message         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

EXAMPLES:

Wrong password
â†’ "Invalid email or password"

Email already exists
â†’ "This email is already registered"

Weak password
â†’ "Password must contain..."

Empty fields
â†’ "Please fill in all fields"

Invalid CSRF token
â†’ "Invalid security token"
```

---

## ğŸ“± User Experience Flow

```
FIRST TIME USER:
1. Visit site
2. See login page
3. Click "Register here"
4. Fill registration form
5. Submit
6. Redirected to login with success message
7. Enter credentials
8. See dashboard

RETURNING USER:
1. Visit site
2. See login page
3. Enter saved credentials
4. See dashboard
5. Use features
6. Logout when done

UNAUTHORIZED ACCESS ATTEMPT:
1. User tries to visit dashboard.php directly
2. System checks: isLoggedIn() â†’ FALSE
3. Redirect to index.php
4. Must login first
```

---

This diagram shows the COMPLETE flow of your system!
Every arrow, every decision, every file interaction. ğŸ¯
